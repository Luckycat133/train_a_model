# 处理器更新日志

[English](../en/for_processor.md) | [中文](./for_processor.md)

---

## [v2.4.0] - 2024-04-18
### ✨ 功能增强 (预训练数据质量提升)

- **日志系统优化**: 重构日志系统，增加颜色区分和更详细的时间戳格式。
- **错误处理改进**: 增强错误处理机制，添加更多上下文信息以便调试。
- **性能优化**: 优化批处理流程，减少内存占用。

## [v2.3.7] - 计划中
### 功能增强 (预训练数据质量提升)

- **个人身份信息 (PII) 编辑**: 计划加入检测和移除/替换姓名、地址、电话号码等个人敏感信息的机制。
- **有害内容过滤**: 计划集成识别和过滤有害、不当或冒犯性内容的功能。
- **质量过滤增强**: 计划引入更精细的质量过滤规则（如基于句子长度、符号比例、重复词比例等）或模型，以过滤低质量文本。
- **标点符号处理调整**: 计划审视并可能调整标点符号的处理逻辑，倾向于保留更多对理解语义重要的标点。

## [v2.3.6] - 2025-04-11
### 功能优化与用户体验提升

- **命令行参数优化**: 改进了 `argparse` 的帮助信息，使用 `ArgumentDefaultsHelpFormatter` 并添加参数分组，使其更清晰易懂。
- **进度条增强**: 优化了 `tqdm` 进度条的格式 (`bar_format`)，在文件读取和批处理阶段提供更详细的进度反馈（如剩余时间、处理速率）。
- **错误处理改进**: 增强了文件读取和预览过程中的错误日志记录，现在会包含具体的异常类型，方便问题排查。

## [v2.3.5] - 2025-04-10
### 测试代码增强
- 创建全面的测试脚本(test_processor.py)用于数据处理功能测试
- 实现不同配置下批处理的性能基准测试
- 添加内存池测试，优化资源管理
- 开发测试环境自动化设置和清理功能
- 实现性能分析的数据收集功能

## [v2.3.4] - 2025-03-25
### 代码优化
- 合并tokenizer相关功能，提高代码一致性
- 优化处理流程，减少冗余操作
- 改进错误处理机制，增强系统稳定性

### 功能增强
- 增强与tokenizer模块的集成能力
- 改进数据处理效率，支持更大规模数据集
- 优化内存使用，减少资源占用

## [v2.3.3] - 2025-03-19
### 架构优化
- 移除分词器训练相关代码，实现与tokenizer.py的职责分离
- 删除_train_tokenizer方法，改为提示用户直接使用tokenizer.py
- 优化命令行参数，移除tokenizer相关选项
- 更新文档和注释，反映最新的架构变更

### 其他改进
- 简化数据优化流程描述，移除tokenizer移动相关内容
- 代码结构优化，提高模块独立性

## [v2.3.2] - 2025-03-15
### 性能优化
- 优化数据处理流程，提高处理速度
- 改进内存管理机制，减少资源占用
- 实现批量处理功能，提升大规模数据处理效率

### 功能增强
- 新增数据验证和清洗功能
- 添加处理进度可视化
- 支持自定义处理规则

## [v2.3.1] - 2025-03-10
### 稳定性提升
- 修复并发处理时的竞争条件
- 解决大文件处理时的内存溢出问题
- 改进错误处理机制

### 功能优化
- 优化数据预处理流程
- 改进文本清理算法
- 增强异常数据检测能力

## [v2.3.0] - 2025-03-05
### 重大更新
- 重构数据处理核心架构
- 实现模块化的处理流程
- 添加插件系统支持

### 新增功能
- 实现数据处理管道
- 添加处理任务调度系统
- 支持自定义处理器扩展

## [v2.2.0] - 2025-02-20
### 功能增强
- 添加数据统计分析功能
- 实现处理结果可视化
- 新增数据导出格式支持

### 系统优化
- 改进配置管理系统
- 优化日志记录机制
- 提升处理器性能

## [v2.1.0] - 2025-02-10
### 新特性
- 实现自动化处理流程
- 添加批处理支持
- 新增处理模板系统

### 改进优化
- 优化处理算法
- 改进内存使用效率
- 增强错误恢复能力

## [v2.0.0] - 2025-02-01
### 架构重构
- 全新的处理器架构设计
- 改进数据处理流程
- 优化核心算法实现

### 功能特性
- 支持多种数据源处理
- 实现数据转换功能
- 添加数据验证系统

## [v1.0.0] - 2025-01-20
### 初始版本
- 基础数据处理功能
- 简单的文本处理支持
- 基本的错误处理机制

## [v2.4.0] - 2024-04-17
### ✨ 功能增强 (预训练数据质量提升)
    - 在 `config/config.yaml` 和命令行参数中添加相关配置 (启用开关、最小/最大长度、符号比例、语言过滤开关、允许语言列表、语言检测方法、fasttext模型路径、重复过滤开关、n-gram大小、重复阈值)。
    - 更新 `requirements.txt` 添加 `langdetect`, `fasttext-wheel`。
- **依赖与配置**: 
    - 更新 `requirements.txt` 以包含所有新依赖。
    - 更新 `config/config.yaml` 添加 `cleaning_rules` 部分，集中管理所有清洗和过滤选项。
    - 优化 `processor.py` 中命令行参数与配置文件合并的逻辑。

### 🗑️ 移除功能
    - 移除有害内容过滤功能及相关配置项
### ✨ 功能增强 (预训练数据质量提升)

- **实现 PII 编辑**: 
    - 集成 `presidio` 库 (`presidio-analyzer`, `presidio-anonymizer`) 用于检测和编辑个人身份信息。
    - 在 `processor.py` 中添加 `pii_redactor` 函数的实际实现，替换之前的占位符。
    - 使用 `spacy` 模型 (例如 `en_core_web_lg`) 支持 PII 检测。
    - 在 `config/config.yaml` 和命令行参数中添加 PII 编辑相关配置 (启用开关、实体列表、编辑方法、替换标签、Spacy模型)。
    - 更新 `requirements.txt` 添加 `presidio-analyzer`, `presidio-anonymizer`, `spacy`。
- **实现有害内容过滤 (基础结构)**:
    - 在 `processor.py` 中添加 `check_harmful_content` 函数，用于判断文本是否有害（当前包含占位符逻辑，待集成模型或API）。
    - 在 `clean_text` 流程中加入此过滤步骤。
    - 在 `config/config.yaml` 和命令行参数中添加有害内容过滤相关配置 (启用开关、模型路径、置信度阈值)。
    - 更新 `requirements.txt` 添加 `transformers` (如果尚不存在或版本需要更新)。
- **实现增强质量过滤**:
    - 在 `processor.py` 的 `clean_text` 函数中加入更精细的质量过滤规则。
    - **长度过滤**: 添加最大长度限制 (`max_length`)。
    - **语言检测**: 使用 `langdetect` 或 `fasttext` (可选) 过滤非指定语言的文本。
    - **重复度检测**: 计算 n-gram 重复率，过滤重复度过高的文本。
    - 在 `config/config.yaml` 和命令行参数中添加相关配置 (启用开关、最小/最大长度、符号比例、语言过滤开关、允许语言列表、语言检测方法、fasttext模型路径、重复过滤开关、n-gram大小、重复阈值)。
    - 更新 `requirements.txt` 添加 `langdetect`, `fasttext-wheel`。
- **依赖与配置**: 
    - 更新 `requirements.txt` 以包含所有新依赖。
    - 更新 `config/config.yaml` 添加 `cleaning_rules` 部分，集中管理所有清洗和过滤选项。
    - 优化 `processor.py` 中命令行参数与配置文件合并的逻辑。
