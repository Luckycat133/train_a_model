  +----------------+
  | 原始文本数据  |
  +-------+------+
          |
          v
  +-------+------+
  |  数据合成器   |
  +-------+------+
          |
          v
  +-------+------+      +----------------+
  |  文本清洗器   |----->|  结构优化器     |
  +-------+------+      +--------+-------+
          |                      |
          v                      |
  +-------+------+              /
  |  数据处理器   |<------------+
  +-------+------+
          |
          v
  +-------+------+
  |  分词器训练   |
  +-------+------+
          |
          v
  +-------+------+
  | JSONL数据文件 |
  +-------+------+
          |
          v
+---------+----------+
|                    |
|  +------+------+   |
|  | 数据集加载  |   |
|  +------+------+   |
|         |          |
|         v          |     +--------------+
|  +------+------+   |     |              |
|  | 模型初始化  |   |     |   梯度累积   |
|  +------+------+   |     |              |
|         |          |     +------+-------+
|         v          |            |
|  +------+------+   |            |
|  | 批次训练    |---+------------+
|  +------+------+   |
|         |          |
|         v          |     +--------------+
|  +------+------+   |     |              |
|  | 验证评估    |<--+---->| 自动调整学习率|
|  +------+------+   |     |              |
|         |          |     +--------------+
|         v          |
|  +------+------+   |
|  | 检查点保存  |   |
|  +------+------+   |
|                    |
| 训练循环           |
+--------------------+
          |
          v
  +-------+------+      +----------------+
  | 最终模型保存  |----->|  文本生成      |
  +-------+------+      +----------------+ 